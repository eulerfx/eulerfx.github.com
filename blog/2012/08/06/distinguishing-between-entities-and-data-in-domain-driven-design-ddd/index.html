
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Distinguishing between entities and data in Domain-Driven Design (DDD) - Lev Gorodinski</title>
	<meta name="author" content="Lev Gorodinski">

	
	<meta name="description" content="In Domain-Driven Design, entities have a strictly defined life-cycle and identity. Accordingly, creation of entity instances should be restricted by &hellip;">
	

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="Lev Gorodinski" type="application/atom+xml">
	
	<link rel="canonical" href="http://gorodinski.com/blog/2012/08/06/distinguishing-between-entities-and-data-in-domain-driven-design-ddd/">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700' rel='stylesheet' type='text/css'>
	
	
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-30683601-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>


</head>

<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><!-- <div class="profilepic">	
	<img src="/images/dp.jpg" alt="Profile Picture" style="width: 160px;">
</div> -->
<h1><a href="/">Lev Gorodinski</a></h1>
<p class="subtitle">Computing, Math, Philosophy</p>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
	<li><a href="/presentations/">Presentations</a></li>
	<li><a href="/about/">About</a></li>
</ul>
</nav>
<nav id="sub-nav">
	<div class="social">
		
		
		<a class="google" href="https://plus.google.com/103805433293437107323?rel=author" title="Google+">Google+</a>
		
		
		<a class="twitter" href="http://twitter.com/eulerfx" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/eulerfx" title="GitHub">GitHub</a>
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</nav>
<section class="stackexchange">
	<br />
	<a href="http://stackoverflow.com/users/13855/eulerfx">
      <img src="http://stackexchange.com/users/flair/7876.png" width="208" height="58" alt="profile for eulerfx at Stack Overflow, Q&amp;A for professional and enthusiast programmers" title="profile for eulerfx at Stack Overflow, Q&amp;A for professional and enthusiast programmers" style="float:left"/>
    </a>
</section>
</header>				
			</div>
		</div>	
		<div class="mid-col">
			
				
<!-- <div id="banner" class="inner">
	<div class="container">
		<ul class="feed"></ul>
	</div>
	<small><a href="http://twitter.com/eulerfx">eulerfx</a> @ <a href="http://twitter.com">Twitter</a></small>
	<div class="loading">Loading...</div>
</div>
<script src="/javascripts/twitter.js"></script>
<script type="text/javascript">
	(function($){
		$('#banner').getTwitterFeed('eulerfx', 5, false);
	})(jQuery);
</script> -->

			
			<div class="mid-col-container">
				<div id="content" class="inner"><article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2012-08-06T22:16:00-04:00" pubdate data-updated="true">Aug 6<span>th</span>, 2012</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/ddd/'>DDD</a>


</div>
	</div>
	<h1 class="title">Distinguishing Between Entities and Data in Domain-Driven Design (DDD)</h1>
	<div class="entry-content"><p>In Domain-Driven Design, entities have a strictly defined life-cycle and identity. Accordingly, creation of entity instances should be restricted by a constructor with required parameters and possibly a factory. <a href="http://gorodinski.com/blog/2012/05/19/validation-in-domain-driven-design-ddd/">Ideally</a>, entities should not be allowed to enter an undefined state such as the state typically resulting from a parameterless constructor. There should be a small number of well defined places where new entity instances are created. Moreover, <a href="http://www.udidahan.com/2009/06/29/dont-create-aggregate-roots/">as described by Udi Dahan</a>, creation of aggregate roots can often be delegated to an existing entity in the context. These constraints simplify reasoning about code in addition to keeping focus on the domain and forcing one to carefully evaluate life-cycle related operations.</p>

<!--more-->


<p>Entities aren&#8217;t created <em>in</em> a vacuum nor are they created <em>from</em> a vacuum - normally there are data which are required for creation. For example, consider a simplified purchase order model:</p>

<p><img class="center" src="http://yuml.me/a593c7c9"></p>

<p>In this case, <strong>PurchaseOrder</strong> is an aggregate root containing a collection of <strong>Invoice</strong> instances which themselves contain <strong>LineItem</strong> instances. In a line of business application, a purchase order would be created to represent a purchase of a set of products or services from a vendor. Subsequently, the vendor sends invoices which are associated with the purchase order. Since <strong>PurchaseOrder</strong> is an aggregate it manages the act of associating invoices with the purchase order. The association is performed by a method on <strong>PurchaseOrder</strong> called <strong>AssociateInvoice</strong> or simply <strong>Invoice</strong> since invoice can be a verb. A naive implementation could be:</p>

<div><script src='https://gist.github.com/3300767.js?file='></script>
<noscript><pre><code>&lt;html&gt;&lt;body&gt;You are being &lt;a href=&quot;https://github.com/gist/3300767&quot;&gt;redirected&lt;/a&gt;.&lt;/body&gt;&lt;/html&gt;</code></pre></noscript></div>


<p>This method certainly gets the job done - it associates an invoice with a purchase order. Unfortunately, this implementation contains flaws and can be improved. For one, because the invoice instance is created outside of the purchase order aggregate, the <strong>Invoice.PurchaseOrder</strong> property must be publicly settable. This makes it difficult to determine whether a specific invoice instance is associated with a purchase order by looking at code alone. From a business perspective, an invoice is always associated with a purchase order and this constraint should be enforced in the code:</p>

<div><script src='https://gist.github.com/3300796.js?file='></script>
<noscript><pre><code>&lt;html&gt;&lt;body&gt;You are being &lt;a href=&quot;https://github.com/gist/3300796&quot;&gt;redirected&lt;/a&gt;.&lt;/body&gt;&lt;/html&gt;</code></pre></noscript></div>


<p>In order to support this implementation, the purchase order has to control the creation of the invoice which means that an <strong>Invoice</strong> object itself cannot be used as before. Instead, an <strong>InvoiceData</strong> object can be declared to contain the <em>data</em> representing an invoice. This object is elusively similar to the <strong>Invoice</strong> object, however it serves a different purpose. It allows the decoupling of the concept of data from the concept of entity thereby supporting the enforcement of domain constraints. Before association with a purchase order invoice data are just data in a vacuum and should therefore be represented as such. This entity data object pattern can be generalized to all cases where entity creation must be strictly controlled.</p>
</div>

</article>


	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	
	<a class="addthis_button_tweet"></a>
	
	
	<a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
	
	<a class="addthis_counter addthis_pill_style"></a>
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>




<div id="banner" class="inner">
	<div class="container">
		<ul class="feed"></ul>
	</div>
	<small><a href="http://twitter.com/eulerfx">eulerfx</a> @ <a href="http://twitter.com">Twitter</a></small>
	<div class="loading">Loading...</div>
</div>
<script src="/javascripts/twitter.js"></script>
<script type="text/javascript">
	(function($){
		$('#banner').getTwitterFeed('eulerfx', 5, false);
	})(jQuery);
</script>



<section id="comment">
    <h1 class="title">Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>
</div>
			</div>
			<footer id="footer" class="inner">Copyright &copy; 2014

    Lev Gorodinski


| Design by <a href="http://shashankmehta.in/archive/2012/greyshade.html">Shashank Mehta</a>
| Powered by <a href="http://octopress.org">Octopress</a></footer>
			<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'eulerfx';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://gorodinski.com/blog/2012/08/06/distinguishing-between-entities-and-data-in-domain-driven-design-ddd/';
        var disqus_url = 'http://gorodinski.com/blog/2012/08/06/distinguishing-between-entities-and-data-in-domain-driven-design-ddd/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-30683601-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



		</div>
	</div>
</body>
</html>
